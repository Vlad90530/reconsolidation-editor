<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Firebase Editor</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
</head>
<body>
  <h1 contenteditable="true" id="title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h1>
  <h3 contenteditable="true" id="author">–ê–≤—Ç–æ—Ä</h3>
  <div contenteditable="true" id="content" style="border:1px solid #ccc; padding:1rem; min-height:200px">
    –ù–∞–ø–∏—à—ñ—Ç—å –≤–∞—à —Ç–µ–∫—Å—Ç —Ç—É—Ç...
  </div>
  <div style="margin-top:1rem">
    <label>üîí –¢–æ–∫–µ–Ω –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è:
      <input type="password" id="editToken" placeholder="–≤–≤–µ–¥—ñ—Ç—å —Ç–æ–∫–µ–Ω">
    </label>
  </div>
  <button onclick="saveToFirebase()">–ó–±–µ—Ä–µ–≥—Ç–∏ —É Firebase</button>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "SENDER_ID",
      appId: "APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function saveToFirebase() {
      const title = document.getElementById("title").innerText.trim();
      const author = document.getElementById("author").innerText.trim();
      const content = document.getElementById("content").innerHTML.trim();
      const editToken = document.getElementById("editToken").value.trim();
      const slug = title.toLowerCase().replace(/[^a-z–∞-—è0-9]+/gi, "-").slice(0, 50);

      if (!editToken) {
        alert("‚ùó –í–≤–µ–¥—ñ—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è");
        return;
      }

      const ref = db.ref("articles/" + slug);

      ref.once("value", snapshot => {
        const existing = snapshot.val();

        if (existing && existing.editToken && existing.editToken !== editToken) {
          alert("üö´ –ù–µ–≤—ñ—Ä–Ω–∏–π —Ç–æ–∫–µ–Ω. –í–∏ –Ω–µ –º–æ–∂–µ—Ç–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ü—é —Å—Ç–∞—Ç—Ç—é.");
          return;
        }

        const article = {
          title,
          author,
          content,
          editToken,
          date: new Date().toISOString()
        };

        ref.set(article)
          .then(() => alert("‚úÖ –°—Ç–∞—Ç—Ç—é –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É Firebase!"))
          .catch((err) => alert("‚ùå –ü–æ–º–∏–ª–∫–∞: " + err.message));
      });
    }
  </script>
</body>
</html>